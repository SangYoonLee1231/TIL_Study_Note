# 애니메이션을 할 때 성능에 유리한 속성이나 방법

- 웹 어플리케이션 FE 개발에서 애니메이션을 적용할 때 '성능에 유리한 속성이나 방법'이 무엇이 있는지, 왜 성능에 유리한것인지 이유에 대해 정리합니다.

<br/><br/>

## 성능 향상를 위해 알아야 할 사전 개념

- CSS 애니메이션을 다룰 때 성능을 고려하는 것은 매우 중요합니다.

- 원활한 프레임 레이트를 유지하기 위해, 브라우저 렌더링(레이아웃 → 페인트 → 합성) 과정을 이해하고 이를 최소화하는 방식으로 애니메이션을 구현해야 합니다.

<br/>

## 브라우저 렌더링 과정 이해

- 브라우저는 크게 다음 단계를 거쳐 화면을 그립니다.

  - 레이아웃(Layout): DOM 요소의 크기와 위치를 계산하는 단계.

  - 페인트(Paint): 요소의 스타일(색상, 텍스트, 테두리 등)을 실제 픽셀로 그려내는 단계.

  - 합성(Compositing): 그려진 요소들을 최종적으로 화면에 배치하는 단계.

- 애니메이션에서 특정 CSS 속성을 변경했을 때, 이 변경이 브라우저의 어떤 단계까지 영향을 미치는지가 성능에 큰 영향을 줍니다.

  - 레이아웃이 다시 계산되면(Reflow, Layout) 상위 단계부터 전부 다시 해야 하므로 비용이 매우 큼.

  - 페인트만 다시 해야 한다면(Layout 단계는 다시 하지 않음) 그보다 비용이 덜 듦.

  - 최종 합성 단계만 다시 하면 되면 가장 비용이 적음.

<br/><br/>

## 성능에 유리한 애니메이션 속성

#### transform (translate/scale/rotate 등)

요소의 기하학적 변형(위치, 회전, 크기 등)을 GPU 레벨에서 처리할 수 있음.

레이아웃(크기나 위치 재계산)에 영향을 주지 않고, 페인트도 재실행하지 않는 경우가 많아(기존 픽셀을 재사용) 최종 합성 단계만 처리함.

- 예: transform: translateX(100px), transform: scale(1.5)

<br/>

#### opacity

불투명도(투명도)만 변경되므로, 레이아웃이나 페인트 단계를 건너뛰고 합성 단계에서 처리 가능한 경우가 많음.

- 예: opacity: 0.5 → 1

<br/>

위 두 속성은 하드웨어 가속을 활용하기 쉽고, 레이아웃·페인트 작업을 최소화할 수 있다는 점에서 애니메이션 성능이 높습니다.

<br/><br/>

## 피해야 할 애니메이션 속성

#### top / left / bottom / right (position 기반 이동)

요소의 좌표 자체를 바꾸므로, 레이아웃이 다시 계산되고, 이후 페인트와 합성 단계까지 모두 발생할 수 있습니다.

이동 효과나 드래그 애니메이션을 구현할 때는 transform: translate()로 대체하는 것이 성능에 훨씬 유리합니다.

<br/>

#### width / height / margin / padding 등 박스 크기나 배치에 영향을 주는 속성

레이아웃이 변하면 그 요소와 주변 요소들의 위치나 크기가 재계산되어야 하기 때문에 비용이 큽니다.

어떤 효과를 구현하려면 scale() 등을 활용하여 박스 내부의 크기 변화를 시뮬레이션하는 방식을 고려해 보세요.

<br/>

#### 색상, 배경 이미지, 그림자(박스 쉐도우), 테두리 등

보통은 레이아웃 단계는 건너뛰더라도, 색상이나 그림자 같이 시각적인 요소는 페인트(Paint) 단계를 다시 수행해야 하므로 부드럽지 않을 수 있습니다.

단, 단순 색상 변화는 레이아웃을 건드리지 않는 경우가 많아 transform/top/left 보다는 덜 부담이 되지만, 요소가 많고 복잡해질수록 페인트 부담도 커질 수 있습니다.

<br/><br/>

## 애니메이션 성능 최적화 방법

#### Transform & Opacity 우선

#### 레이아웃 재계산과 페인트 최소화

#### will-change, GPU 가속: 3D 변환을 살짝 이용하거나 will-change 속성을 통해 브라우저가 미리 GPU 레이어를 생성하게 하면 성능에 이점이 있으나, 남용은 금물.

#### JS 제어 시 requestAnimationFrame(): JavaScript로 애니메이션을 구현해야 할 때는 브라우저 리프레시 주기와 동기화되는 requestAnimationFrame()을 사용.

<br/>
